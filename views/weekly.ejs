<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tanggal Minggu Ini</title>
</head>
<body>
    <script>
        function getWeekDates(date = new Date()) {
            const currentDate = new Date(date);
            const dayOfWeek = currentDate.getDay();

            const startOfWeek = new Date(currentDate);
            startOfWeek.setDate(currentDate.getDate() - (dayOfWeek === 0 ? 6 : dayOfWeek - 1));

            const weekDates = [];
            for (let i = 0; i < 7; i++) {
                const date = new Date(startOfWeek);
                date.setDate(startOfWeek.getDate() + i);
                weekDates.push(resetTimeToMidnight(date));
            }

            return weekDates;
        }

        function resetTimeToMidnight(date) {
            const newDate = new Date(date);
            newDate.setUTCHours(0, 0, 0, 0);
            const isoString = newDate.toISOString();
            return isoString.replace('Z', '+00:00');
        }

        const weekDates = getWeekDates();
        const { firstDate, lastDate } = getFirstAndLastDates(weekDates);

        document.getElementById('first-date').textContent = `Tanggal paling awal: ${firstDate}`;
        document.getElementById('last-date').textContent = `Tanggal paling akhir: ${lastDate}`;

        function getFirstAndLastDates(dates) {
            if (dates.length === 0) return { firstDate: null, lastDate: null };
            return {
                firstDate: dates[0],
                lastDate: dates[dates.length - 1]
            };
        }

        sendDatetoServer(firstDate, lastDate);

        async function sendDatetoServer(firstDate, lastDate) {
            const response = await fetch('/senddate-server', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    firstDate: firstDate,
                    lastDate: lastDate,
                }),
            });

            if (!response.ok) {
                throw new Error('Network response was not ok');
            }

            const data = await response.json();
            console.log('Data received from server:', data);
        };
    </script>
</body>
</html>
